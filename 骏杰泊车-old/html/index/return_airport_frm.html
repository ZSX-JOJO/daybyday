<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width" />
<meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
<title>Hello APP</title>
<link rel="stylesheet" type="text/css" href="../../css/aui.css" />
<link rel="stylesheet" type="text/css" href="../../css/common.css" />
<style>
	body {
		background: #f6f8fa;
	}
	.info {
		background: #fff;
		padding: 0 0.75rem;
	}
	.airport-info img.img-arrow {
		margin-top: 1.2rem;
		display: inline-block !important;
		width: 1.05rem !important;
		height: auto !important;
	}
	.aui-info {
		height: 2.5rem;
	}
	.info .aui-info-item img.arrowRight {
		height: 0.5rem;
		display: block;
	}
	.aui-card-list-footer {
		height: 2.5rem;
		line-height: 2.5rem;
		padding-top: 0;
		padding-bottom: 0;
		background: #fff;
	}
	.aui-card-list-footer img.img-icon {
		display: inline-block !important;
		width: auto !important;
		height: 0.8rem !important;
		position: relative;
		top: 2px;
		margin-right: 0.2rem;
	}
	.info .aui-info-item img.data-icon {
		width: auto;
		height: 0.65rem !important;
	}
	.info .aui-info-item img.airport-icon {
		height: 0.6rem;
		margin-left: 0.5rem;
		width: 0.75rem;
		display: block;
	}
	.padding-t-b {
		padding-top: 0.75rem;
		padding-bottom: 0.45rem;
	}
	.nextBtn {
		font-size: 0.8rem;
		line-height: 2.25rem;
		height: 2.25rem;
		margin-top: 5rem;
		background-color: #083a91 !important;
		color: #FFF !important;
		border-radius: 1.15rem;
	}
	.aui-card-list {
		margin-bottom: 0;
	}
	.aui-grid .aui-grid-label.airport-name {
		font-size: 0.85rem;
	}
	@media all and (max-width:350px){
		.aui-grid .aui-grid-label.airport-name {
			font-size: 0.75rem;
		}
	}
</style>
</head>

<body>
<section class="aui-content">
	<div>
		<div class="aui-font-size-12 aui-text-center padding-t-b">回程/目的机场</div>
		<div class="aui-card-list">
			<div class="aui-card-list-content aui-grid airport-info">
				<div class="aui-row aui-padded-l-15 aui-padded-r-15">
					<div class="aui-col-xs-5" tapmode onClick="openAirPort('destination_airport_win','depart_name');">
						<p class="font-size-13">回程机场</p>
						<div class="aui-grid-label text-common airport-name" id="depart_name">-</div>
					</div>
					<div class="aui-col-xs-2 arrow-wrap"> <img src="../../image/index/56.png" class="img-arrow" /> </div>
					<div class="aui-col-xs-5" tapmode onClick="openAirPort('destination_airport_win','dest_name');">
						<p class="font-size-13">目的机场</p>
						<div class="aui-grid-label text-common airport-name" id="dest_name">-</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div>
		<div class="aui-font-size-12 aui-text-center padding-t-b">返回日期</div>
		<div class="aui-info info text-dark" tapmode onclick="selectItem('reserve_date_win');">
			<div class="aui-info-item font-size-15">请选择返回日期</div>
			<div class="aui-info-item aui-padded-r-15 right-arrow">
				<p class="aui-margin-r-5"><img src="../../image/index/57.png" alt="" class="data-icon"></p>
				<p id="depart_date"></p>
			</div>
		</div>
	</div>
	<div>
		<div class="aui-font-size-12 aui-text-center padding-t-b">选择航班</div>
		<div class="aui-info info text-dark" tapmode onclick="openHangban();">
			<div class="aui-info-item font-size-15">
				<div>请选择航班</div>
				<div><img src="../../image/index/58.png" alt="" class="airport-icon"></div>
			</div>
			<div class="aui-info-item aui-padded-r-15 right-arrow">
				<p id="flight_name"></p>
			</div>
		</div>
	</div>
	<div>
		<div class="aui-font-size-12 aui-text-center padding-t-b">选择接车时间</div>
		<div class="aui-info info text-dark" tapmode onclick="selectDate();">
			<div class="aui-info-item font-size-15">请选择接车时间</div>
			<div class="aui-info-item aui-padded-r-15 right-arrow">
				<p id="date_time"></p>
			</div>
		</div>
	</div>
<!--  kaisi-->
	<div id="other-srv-wrap">

	</div>
	<script type="text/x-dot-tpl" id="other-srv-tpl">
		<div class="aui-font-size-12 aui-text-center padding-t-b">其他服务</div>
		{{for(var i in it){}}
		{{? it[i].item_price_type == "1"}}
		<div class="info" tapmode onClick="selectOil({{=it[i].item_id}},'{{=it[i].item_name}}');" id="item-{{=it[i].item_id}}">
		{{?? it[i].item_price_type == "2"}}
		<div class="info" tapmode onClick="selectItem('carwash_win',{{=it[i].item_id}},'{{=it[i].item_name}}');" id="item-{{=it[i].item_id}}">
		{{?}}
			<div class="aui-info text-dark aui-border-b right-arrow aui-padded-r-15">
				<div class="aui-info-item font-size-15">{{=it[i].item_name}}</div>
				<div class="aui-info-item aui-font-size-14 oil_data"></div>
			</div>
		</div>
		{{ }}}
	</script>
	<!-- jieshu  -->

</section>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/dom7.js"></script>
<script type="text/javascript" src="../../script/dot.min.js"></script>
<script type="text/javascript">
	var pageData;
	var park_id;
    apiready = function() {
		api.parseTapmode();
		pageData = api.pageParam;
		park_id = api.pageParam.park_id;
		//
		document.getElementById("depart_name").textContent = pageData.data_airport_1;
		document.getElementById("depart_name").setAttribute("data-AirportCode",pageData.destAirportCode);
		document.getElementById("dest_name").textContent = pageData.data_departure_airport;
		document.getElementById("dest_name").setAttribute("data-AirportCode",pageData.departAirportCode);

		// loadParkData();
    };
	function loadParkData(){
		var postData = {};
		postData.park_id = park_id;
		api.ajax({
		    url: BASE_URL + 'App/Parking/parkDetail',
		    method: 'post',
		    data: {
		        values: postData
		    }
		},function(ret, err){
		    if (ret) {
		        if(ret.code == 1){
					if(ret.srv){
						var srvTpl = document.getElementById("other-srv-tpl").innerHTML;
						var srvFn = doT.template(srvTpl);
						document.getElementById("other-srv-wrap").innerHTML = srvFn(ret.srv);
						api.parseTapmode();
					}
				}
		    }
		});
	}
	function selectDate(){
		api.openFrame({
			name: 'date_mask',
			url: 'date_mask.html',
			rect: {
				x: 0,
				y: 0,
				w: 'auto',
				h: 'auto'
			},
			pageParam: {
				wname: api.winName,
				fname: api.frameName
			}
		});
	}
	function openAirPort(url,domId){
		api.openWin({
			name: url,
			url: url + '.html',
			slidBackEnabled:false,
			pageParam: {
				domId:domId,
				wname: api.winName,
				fname: api.frameName
			}
		});
	}
	//修改项目
	function selectItem(url,itemId,itemName){
		api.openWin({
			name: url,
			url: url + '.html',
			slidBackEnabled:false,
			pageParam: {
				item_id:itemId,
				item_name:itemName,
				wname: api.winName,
				fname: api.frameName
			}
		});
	}
	// 打开选择航班
	function openHangban(){
		var pageParam = {};
		pageParam.dep = document.getElementById("depart_name").getAttribute("data-AirportCode");
		pageParam.arr = document.getElementById("dest_name").getAttribute("data-AirportCode");
		pageParam.date = document.getElementById("depart_date").textContent;
		pageParam.wname = api.winName;
		pageParam.fname = api.frameName;
		api.openWin({
		    name: 'select_flight_win',
		    url: 'select_flight_win.html',
		    pageParam: pageParam
		});

	}
	function changeFlightData(FlightCompany,FlightNo,FlightDeptimePlanDate,FlightArrtimePlanDate,FlightDepAirport,FlightArrAirport){
		document.getElementById("flight_name").textContent = FlightCompany+FlightNo;
		document.getElementById("flight_name").setAttribute("data-FlightCompany",FlightCompany);
		document.getElementById("flight_name").setAttribute("data-FlightNo",FlightNo);
		document.getElementById("flight_name").setAttribute("data-FlightDeptimePlanDate",FlightDeptimePlanDate);
		document.getElementById("flight_name").setAttribute("data-FlightArrtimePlanDate",FlightArrtimePlanDate);

		document.getElementById("flight_name").setAttribute("data-FlightDepAirport",FlightDepAirport);
		document.getElementById("flight_name").setAttribute("data-FlightArrAirport",FlightArrAirport);
	}
	function selectOil(itemId,itemName){
		api.openFrame({
			name: 'oil_mask',
			url: 'oil_mask.html',
			rect: {
				x: 0,
				y: 0,
				w: 'auto',
				h: 'auto'
			},
			pageParam: {
				item_id:itemId,
				item_name:itemName,
				wname: api.winName,
				fname: api.frameName
			}
		});
	}
	function changeAirPortData(domId,name,CityCode,AirportCode){
		$$('#'+ domId).text(name);
		document.getElementById(domId).setAttribute("data-CityCode",CityCode);
		document.getElementById(domId).setAttribute("data-AirportCode",AirportCode);
	}
	//返回数据更改
	function changeSrvData(domId,srvName,srvAmount,itemId){
		$$('#item-'+itemId+' .oil_data').text(srvName+srvAmount+"元");
		$$('#item-'+itemId+' .oil_data').attr("srv-name",srvName);
		$$('#item-'+itemId+' .oil_data').attr("srv-amount",srvAmount);
	}
	function changeData(domId,text){
		document.getElementById(domId).textContent = text;
	}
	var oilTxt,oilPrice;
	function getOil(txt,price,itemId){
		oilTxt = txt;
		oilPrice = price;
		$$('#item-'+itemId+' .oil_data').text(txt + price+"元");
		$$('#item-'+itemId+' .oil_data').attr("srv-name",txt);
		$$('#item-'+itemId+' .oil_data').attr("srv-amount",price);
	}
	function getDate(date){
		if(date){
			document.getElementById("depart_date").textContent = date;
		}
	}
	function getHourM(date){
		var d = new Date(date);
		var h = d.getHours();
		var m = d.getMinutes();
		var hm = h+":"+m;
		return hm;
	}


	function charge_win(){
		// 获取回程信息
		var data_return_airport = pageData.data_return_airport = document.getElementById("depart_name").textContent;//出发机场
		var data_airport_2 = pageData.data_airport_2 = document.getElementById("dest_name").textContent;//目的机场
		var data_return_time = pageData.data_return_time =  document.getElementById("depart_date").textContent;//出发日期

		var data_return_flight = pageData.data_return_flight = document.getElementById("flight_name").getAttribute("data-FlightNo");
		var data_return_flight_name = pageData.data_return_flight_name = document.getElementById("flight_name").getAttribute("data-FlightCompany");

		var FlightDeptimePlanDate = document.getElementById("flight_name").getAttribute("data-FlightDeptimePlanDate");
		var FlightArrtimePlanDate = document.getElementById("flight_name").getAttribute("data-FlightArrtimePlanDate");
		var FlightDepAirport = document.getElementById("flight_name").getAttribute("data-FlightDepAirport");
		var FlightArrAirport = document.getElementById("flight_name").getAttribute("data-FlightArrAirport");

		var data_return_flight_info = pageData.data_return_flight_info = FlightDepAirport+getHourM(FlightDeptimePlanDate)+" - "+FlightArrAirport+getHourM(FlightArrtimePlanDate);

		var data_return_airport_code = pageData.data_return_airport_code = document.getElementById("depart_name").getAttribute("data-AirportCode");
		var data_airport_2_code = pageData.data_airport_2_code = document.getElementById("dest_name").getAttribute("data-AirportCode");

		// console.log(JSON.stringify(pageData));return;
		// 获取其他服务
		api.openWin({
		    name: 'charge_win',
		    url: 'charge_win.html',
		    pageParam: pageData
		});
	}
</script>
</html>

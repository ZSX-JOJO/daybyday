<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width" />
<meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
<title>Hello APP</title>
<link rel="stylesheet" type="text/css" href="../../css/aui-flex.css" />
<link rel="stylesheet" type="text/css" href="../../css/aui.css" />
<link rel="stylesheet" type="text/css" href="../../css/common.css" />
<style>
	body {
		background: none;
	}
.oilList li {
	margin-bottom: 1rem;
	width: 4.15rem;
	height: 1.6rem;
	line-height: 1.6rem;
	text-align: center;
	font-size: 0.75rem;
	color: #FFF;
	background: #d3d3d3;
	border-radius: 0.2rem;
}
.oilList li.on {
	background: #083a91;
}
.numInput {
	font-size: 0.8rem !important;
}
.red {
	color: #f8644c !important;
}
</style>
</head>
<body>
<div class="popOverlay" tapmode onClick="api.closeFrame();"></div>
<div class="popup popMiddle" style="width: 12.5rem;">
	<div class="popHeader aui-border-b">
		<div class="close" tapmode onClick="api.closeFrame();"></div>
		<div class="aui-ellipsis-1">代<span id="item-name"></span>类型/价格</div>
	</div>
	<div class="popInner aui-padded-15 aui-padded-b-5">
		<div class="aui-padded-l-15 aui-padded-r-15">
			<div id="data-wrap"></div>

			<div class="aui-flex-col aui-flex-middle aui-flex-between">
				<div class="aui-flex-item-10">
					<input type="number" placeholder="请输入金额" class="numInput red">
				</div>
				<div class="aui-font-size-16 red">元</div>
			</div>
		</div>
	</div>
	<div class="popFooter aui-border-t">
		<div class="saveBtn text-common" tapmode onClick="save();">确定</div>
	</div>
</div>
<script type="text/x-dot-template" id="data-tpl">
	<ul class="oilList aui-flex-col aui-flex-middle aui-flex-between">
		{{for(var i in it){}}
		<li {{? i == 0}}class="on"{{?}}>{{=it[i].srv_name}}</li>
		{{ } }}
	</ul>
</script>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/aui-tap.js"></script>
<script type="text/javascript" src="../../script/dom7.js"></script>
<script type="text/javascript" src="../../script/dot.min.js"></script>
<script type="text/javascript">
	var item_id;
    apiready = function() {
		item_id = api.pageParam.item_id;
		document.getElementById("item-name").textContent = api.pageParam.item_name;
        api.parseTapmode();
		loadData();
    };
	function loadData(){
		var postData = {};
		postData.item_id = item_id;
		api.ajax({
		    url: BASE_URL + "App/Parking/otherSrv",
		    method: 'post',
		    data: {
		        values: postData
		    }
		},function(ret, err){
		    if (ret) {
		        if(ret.code == 1){
					var tpl = document.getElementById("data-tpl").innerHTML;
					var fn = doT.template(tpl);
					document.getElementById("data-wrap").innerHTML = fn(ret.data);
					api.parseTapmode();
					$$('.oilList').on('tap','li', function(e) {
						$$(this).addClass('on').siblings().removeClass('on');
					});
				}
		    }
		});

	}
	var mt = -($$('.popMiddle').outerHeight()/2);
	$$('.popMiddle').css('margin-top', mt+'px');

	$$('.oilList').on('tap','li', function(e) {
		$$(this).addClass('on').siblings().removeClass('on');
	});
	function save(){
		var txt = $$('.oilList li.on').text();
		var price = $$('.numInput').val() ? ' '+$$('.numInput').val() : '';
		if(price){
			var jsfun = 'getOil("'+txt+'","'+price+'","'+item_id+'")';
			api.execScript({
				name: api.pageParam.wname,
				frameName: api.pageParam.fname,
				script: jsfun
			});
			api.closeFrame();
		}else{
			$$('.numInput').focus();
		}
	}
</script>
</html>

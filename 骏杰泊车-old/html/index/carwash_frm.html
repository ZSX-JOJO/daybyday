<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width"/>
<meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
<title>Hello APP</title>
<link rel="stylesheet" type="text/css" href="../../css/aui-flex.css" />
<link rel="stylesheet" type="text/css" href="../../css/aui.css" />
<link rel="stylesheet" type="text/css" href="../../css/common.css" />
<style>
body {
	color: #FFF;
	background: #232323;
}
.aui-content {
	padding: 4rem 1rem 0.75rem;
}
.item {
	height: 4.5rem;
	background-color: #2b3743;
	border-radius: 0.2rem;
	font-size: 0.8rem;
	width: 45%;
	text-align: center;
}
.aui-radio {
	width: 0.9rem;
	width: 0.9rem;
	height: 0.9rem;
	background: none;
	border: 1px solid #FFF;
}
.aui-radio.aui-checked {
	border: none !important;
	background-color: #fff;
}
.aui-radio.aui-checked:before, .aui-radio.aui-checked:after {
	border-color: #232323;
}
.com-btm-btn {
	margin-top: 10rem;
}
</style>
</head>
<body>
<div class="aui-content">
	<div class="aui-flex-col aui-flex-middle aui-flex-between" id="data-wrap"></div>
	<script type="text/x-dot-tpl" id="data-tpl">
	{{for(var i in it) {}}
	<div class="item aui-flex-row aui-flex-middle aui-flex-center outline" tapmode onClick="checkThis(this);" style="margin-bottom:15px;">
		<div class="aui-margin-b-10" srv-name="{{=it[i].srv_name||''}}" srv-amount="{{=it[i].srv_amount||'0.00'}}">{{=it[i].srv_name||''}}{{=it[i].srv_amount||'0.00'}}元</div>
		<div class="aui-radio {{? i == 0}}aui-checked{{?}}"></div>
	</div>
	{{ } }}
	</script>
	<div class="com-btm-btn" tapmode onClick="save();">确 认</div>
</div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/dom7.js"></script>
<script type="text/javascript" src="../../script/dot.min.js"></script>
<script type="text/javascript">
	var item_id;
	var winName,frameName;
    apiready = function(){
		api.parseTapmode();
		item_id = api.pageParam.item_id;
		winName  = api.pageParam.wname;
		frameName  = api.pageParam.fname;
		// alert(winName+'-'+frameName)
		loadData();
    };
	function loadData(){
		var postData = {};
		postData.item_id = item_id;
		api.ajax({
		    url: BASE_URL + "App/Parking/otherSrv",
		    method: 'post',
		    data: {
		        values: postData
		    }
		},function(ret, err){
		    if (ret) {
		        if(ret.code == 1){
					var tpl = document.getElementById("data-tpl").innerHTML;
					var fn = doT.template(tpl);
					document.getElementById("data-wrap").innerHTML = fn(ret.data);
					api.parseTapmode();
				}
		    }
		});

	}
	function checkThis(n){
		$$(n).find('.aui-radio').addClass('aui-checked');
		$$(n).siblings().find('.aui-radio').removeClass('aui-checked');
	}
	function save(){
		var txt = $$('.aui-checked').prev().text();
		var srvName = $$('.aui-checked').prev().attr('srv-name');
		var srvAmount = $$('.aui-checked').prev().attr('srv-amount');
		var jsfun = 'changeSrvData("carwash_data","'+ srvName +'","'+ srvAmount +'","'+item_id+'")';
		api.execScript({
			name: api.pageParam.wname,
			frameName: api.pageParam.fname,
			script: jsfun
		});
		api.setStatusBarStyle({
			style: 'dark'
		});
		api.closeWin();
	}
</script>
</html>

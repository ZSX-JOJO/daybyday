<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
<title>Hello APP</title>
<link rel="stylesheet" type="text/css" href="../../css/aui.css" />
<link rel="stylesheet" type="text/css" href="../../css/common.css" />
<style type="text/css">
/*右侧索引大容器*/
.indexBox {
	width: 0.75rem;
	position: fixed;
	color: #3f74e9;
	height: 100%;
	z-index: 9999;
	right: 0;
	/*设为弹性盒子*/
	display: -webkit-box;
	display: box;
	/*盒子内子元素纵向显示*/
	-webkit-box-orient: vertical;
	box-orient: vertical;
}
/*右侧共分三部分，竖向排列，第一，三部分高度一致，实现字母索引上下居中效果*/
.items {
	-webkit-box-flex: 1;
	box-flex: 1;
}
/*当前字母提示窗*/
#views {
	width: 90px;
	height: 90px;
	position: fixed;
	display: none;
	z-index: 9999;
	font-size: 50px;
	background: rgba(0,0,0,.5);
	border-radius: 8px;
	text-align: center;
	line-height: 90px;
	color: white;
	margin: auto;
	left: 0;
	right: 0;
	top: 0;
	bottom: 0;
}
/*右侧索引字母*/
#mainWord li {
	line-height: 0.85rem;
	text-align: center;
	font-size: 0.55rem;
}
/*列表*/
	#data-html {
		margin-right: 0.75rem;
	}
.titles {
	height: 1.75rem;
	padding: 0.75rem 0.75rem 0;
	font-size: 0.6rem;
	line-height: 1;
	color: #999;
	background: #f6f8fa;
}
.dataList li {
	padding-left: 0.75rem;
	font-size: 0.75rem;
	color: #333;
	background-color: #FFF;
}
.dataList li div {
	height: 2.5rem;
	line-height: 2.5rem;
}
.dataList li:last-child .aui-border-b {
	border: none;
	background: none;
}
</style>
</head>
<body>
<div id="views"></div>
<div class="indexBox">
	<ul class="items" id="startMark">
	</ul>
	<ul id="mainWord">
	</ul>
	<ul class="items">
	</ul>
</div>
<div id="data-html">
	<div id="#" class="titles">#</div>
	<ul class="dataList">
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">其他</div>
		</li>
	</ul>
	<div id="A" class="titles">A</div>
	<ul class="dataList">
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
	</ul>
	<div id="B" class="titles">B</div>
	<ul class="dataList">
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">宝马</div>
		</li>
	</ul>
	<div id="C" class="titles">C</div>
	<ul class="dataList">
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
	</ul>
	<div id="D" class="titles">D</div>
	<ul class="dataList">
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
		<li>
			<div class="aui-border-b" tapmode onClick="select(this);">奥迪</div>
		</li>
	</ul>
</div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/jquery.min.js"></script>
<script type="text/javascript">
    var source;
    //右侧索引数组
    var marks = [];
    var mainWord = "";
    var aWordH;
    apiready = function(){
        api.parseTapmode();

    };
    listTouch();
	function select(n){
		var brand = $(n).text();
		api.openWin({
			name: 'select_pop_win',
			url: 'select_pop_win.html',
			pageParam: {
		        brand: brand
		    }
		});
	}




    function listTouch(){
        $(".titles").each(function() {
            //循环读取标题字母，添加至数组和界面上的容器
            marks.push($.trim($(this).text()));
            mainWord += "<li>" + $(this).text() + "</li>"
        });
        $("#mainWord").html(mainWord);
        //		获取第一个字母相对于屏幕的高度
        var startMark = document.getElementById('startMark').offsetHeight;
        //	获取单个字母的高度
        aWordH = document.getElementById('mainWord').offsetHeight / marks.length;
        $("#mainWord").on("touchstart", function(e) {

            //手指接触屏幕了，获得相对位置，就是手指距离第一个字母的位置
            event.preventDefault();
            var innerSy = e.originalEvent.targetTouches[0].clientY;
            //去另一个函数里进行判断，得到目前手指覆盖了哪个字母
            //下面的move事件一样的原理
            goMark(innerSy - startMark);
        });
        //			监听手指在索引字母上的滑动位置，判断字母
        $("#mainWord").on("touchmove", function(e) {
            var innerMy = e.originalEvent.targetTouches[0].clientY;
            goMark(innerMy - startMark);
        });
        $("body").on("touchend", function() {
            $("body").css("overflow", "visible");
            $("#views").hide();
        });
        $("body").on("touchstart", function() {
            $("body").css("overflow", "visible");
            $("#views").hide();
        });
    }

    //判断字母的方法
    function goMark(nums) {
        //				先锁定页面
        $("body").css("overflow", "hidden");
        //				显示字母提示窗
        $("#views").show();
        //当前手指距离第一个字母的位置除以单个字母的高度，取整数，这个数字就是当前手指覆盖了的字母在数组中的索引
        //字母放入提示窗
        $("#views").html(marks[parseInt(nums / aWordH)]);
        //锚标记定位
        location.hash = "#" + marks[parseInt(nums / aWordH)];
        location.hash = "#clear";
    }
</script>
</html>

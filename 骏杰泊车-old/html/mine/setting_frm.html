<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
<title>title</title>
<link rel="stylesheet" type="text/css" href="../../css/aui-flex.css"/>
<link rel="stylesheet" type="text/css" href="../../css/aui.css"/>
<link rel="stylesheet" type="text/css" href="../../css/common.css"/>
<style>
body {
	background-color: #F6F8FA;
}
.sec {
	padding: 0 0.75rem;
	background: #FFF;
	margin-top: 0.3rem;
}
.item {
	padding-right: 0.55rem;
	height: 2.5rem;
	font-size: 0.75rem;
}
.com-btm-btn {
	background: #FFF;
	color: #083a91;
}
</style>
</head>
<body>
<div class="aui-content">
	<div class="sec lastNoBorder">
		<div class="item aui-flex-col aui-flex-middle aui-flex-between aui-border-b right-arrow" tapmode onclick="openWin('set_basic_win')">
			<div>个人信息</div>
			<div></div>
		</div>
	</div>
	<div class="sec lastNoBorder">
		<div class="item aui-flex-col aui-flex-middle aui-flex-between aui-border-b right-arrow" tapmode onclick="openWin('set_account_win')">
			<div>账号信息</div>
			<div></div>
		</div>
	</div>
	<div class="sec lastNoBorder">
		<div class="item aui-flex-col aui-flex-middle aui-flex-between aui-border-b right-arrow" tapmode onclick="cls()">
			<div>清理缓存</div>
			<div class="aui-font-size-14 text-light">已使用<span id="cacheSize">34M</span></div>
		</div>
		<div class="item aui-flex-col aui-flex-middle aui-flex-between aui-border-b right-arrow">
			<div>检测新版本</div>
			<div class="aui-font-size-14 text-light">当前版本v1.0.0</div>
		</div>
	</div>
	<div class="sec lastNoBorder">
		<div class="item aui-flex-col aui-flex-middle aui-flex-between aui-border-b right-arrow" tapmode onclick="openWin('feedback_win')">
			<div>意见反馈</div>
			<div></div>
		</div>
		<div class="item aui-flex-col aui-flex-middle aui-flex-between aui-border-b right-arrow" tapmode onclick="openWin('about_us_win')">
			<div>关于我们</div>
			<div></div>
		</div>
		<div class="item aui-flex-col aui-flex-middle aui-flex-between aui-border-b right-arrow" tapmode onclick="openWin('help_center_win')">
			<div>帮助中心</div>
			<div></div>
		</div>
	</div>
</div>
<div class="aui-padded-15" style=	"margin-top: 3rem;">
	<div class="com-btm-btn" tapmode onclick="logout()">退出登录</div>
</div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript">
	var userid;
	apiready = function(){
		api.parseTapmode();

		getCache();

		api.addEventListener({
		    name: 'loginSuccessEvent'
		}, function(ret, err) {
		    if (ret) {
		    	userid = $api.getStorage('userid');
		    }
		});
	};
    function openWin(url){
        api.openWin({
            name: url,
            url: url + '.html'
        });
    }
	function getCache(){
		api.getCacheSize(function(ret) {
			var size = ret.size;
			var txt;
			switch (size) {
				case -1:
					txt = '无存储设备';
					break;
				case -2:
					txt = '正在准备USB存储设备';
					break;
				case -3:
					txt = '无法访问存储设备';
					break;
				default:
					var mb = size/1024/1024;
					txt = mb.toFixed(1)+'M';
			}
			$api.html($api.byId('cacheSize'),txt);
		});
	}
    function cls(){
        api.confirm({
            title: '确定清除缓存',
            msg: '',
            buttons: ['取消', '确定']
        }, function(ret, err) {
            var index = ret.buttonIndex;
            if(index == 2){
                api.clearCache(function() {
                    api.toast({
                        location: 'middle',
                        msg: '清除完成'
                    });
                    getCache();
                });
            }
        });
    }
    function logout(){
    	$api.rmStorage('userid');
    	api.sendEvent({
    	    name: 'logoutSuccessEvent'
    	});
    	api.toast({
    	    msg: '退出成功',
    	    location:'middle'
    	});
    	setTimeout(function(){
    		api.closeToWin({
	    	    name: 'root'
	    	});
    	},300);
    }
</script>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>图片懒加载</title>
    <style>
        *{
            margin:0;
            padding:0;
        }

        .content{
            width:400px;
            margin:0 auto;
            color:brown;
        }

        img.loaded{
            width:400px;
        }

        img{
            width:300px;
        }

        p{
            font-weight:bold;
            color:red;
        }
    </style>
</head>
<body>
    <div class="content">
        通俗的讲就是：当访问一个页面的时候，先把img元素或是其他元素的背景图片路径 替换成一张大小为1*1px图片的路径（这样就只需请求一次）， 只有当图片出现在浏览器的可视区域内时，才设置图片正真的路径， 让图片显示出来。这就是图片懒加载。
        <p>
            关键点如下： 1、页面中的img元素，如果没有src属性， 浏览器就不会发出请求去下载图片（也就没有请求咯，也就提高性能咯）， 一旦通过javascript设置了图片路径，浏览器才会送请求。有点按需分配的意思， 你不想看，就不给你看，你想看了就给你看~ 2、如何获取正真的路径，这个简单， 现在正真的路径存在元素的“data-url”（这个名字起个自己认识好记的就行）属性里， 要用的时候就取出来，再设置；
        </p>
        <p>
            <img data-src="./image/1.jpg" src="./image/logos.png" class="lazyload" alt="" />
        </p>
        
        通俗的讲就是：当访问一个页面的时候，先把img元素或是其他元素的背景图片路径 替换成一张大小为1*1px图片的路径（这样就只需请求一次）， 只有当图片出现在浏览器的可视区域内时，才设置图片正真的路径， 让图片显示出来。这就是图片懒加载。
        <p>
            关键点如下： 1、页面中的img元素，如果没有src属性， 浏览器就不会发出请求去下载图片（也就没有请求咯，也就提高性能咯）， 一旦通过javascript设置了图片路径，浏览器才会送请求。有点按需分配的意思， 你不想看，就不给你看，你想看了就给你看~ 2、如何获取正真的路径，这个简单， 现在正真的路径存在元素的“data-url”（这个名字起个自己认识好记的就行）属性里， 要用的时候就取出来，再设置；
        </p>
        <p>
            <img data-src="./image/2.jpg" src="./image/star.png" class="lazyload" alt="" />
        </p>

        通俗的讲就是：当访问一个页面的时候，先把img元素或是其他元素的背景图片路径 替换成一张大小为1*1px图片的路径（这样就只需请求一次）， 只有当图片出现在浏览器的可视区域内时，才设置图片正真的路径， 让图片显示出来。这就是图片懒加载。
        <p>
            关键点如下： 1、页面中的img元素，如果没有src属性， 浏览器就不会发出请求去下载图片（也就没有请求咯，也就提高性能咯）， 一旦通过javascript设置了图片路径，浏览器才会送请求。有点按需分配的意思， 你不想看，就不给你看，你想看了就给你看~ 2、如何获取正真的路径，这个简单， 现在正真的路径存在元素的“data-url”（这个名字起个自己认识好记的就行）属性里， 要用的时候就取出来，再设置；
        </p>
        <p>
            <img data-src="./image/3.jpg" src="./image/star.png" class="lazyload" alt="" />
        </p>

        通俗的讲就是：当访问一个页面的时候，先把img元素或是其他元素的背景图片路径 替换成一张大小为1*1px图片的路径（这样就只需请求一次）， 只有当图片出现在浏览器的可视区域内时，才设置图片正真的路径， 让图片显示出来。这就是图片懒加载。
        <p>
            关键点如下： 1、页面中的img元素，如果没有src属性， 浏览器就不会发出请求去下载图片（也就没有请求咯，也就提高性能咯）， 一旦通过javascript设置了图片路径，浏览器才会送请求。有点按需分配的意思， 你不想看，就不给你看，你想看了就给你看~ 2、如何获取正真的路径，这个简单， 现在正真的路径存在元素的“data-url”（这个名字起个自己认识好记的就行）属性里， 要用的时候就取出来，再设置；
        </p>
        <p>
            <img data-src="./image/4.jpg" src="./image/star.png" class="lazyload" alt="" />
        </p>

        通俗的讲就是：当访问一个页面的时候，先把img元素或是其他元素的背景图片路径 替换成一张大小为1*1px图片的路径（这样就只需请求一次）， 只有当图片出现在浏览器的可视区域内时，才设置图片正真的路径， 让图片显示出来。这就是图片懒加载。
        <p>
            关键点如下： 1、页面中的img元素，如果没有src属性， 浏览器就不会发出请求去下载图片（也就没有请求咯，也就提高性能咯）， 一旦通过javascript设置了图片路径，浏览器才会送请求。有点按需分配的意思， 你不想看，就不给你看，你想看了就给你看~ 2、如何获取正真的路径，这个简单， 现在正真的路径存在元素的“data-url”（这个名字起个自己认识好记的就行）属性里， 要用的时候就取出来，再设置；
        </p>
        <p>
            <img data-src="./image/5.jpg" src="./image/star.png" class="lazyload" alt="" />
        </p>

        通俗的讲就是：当访问一个页面的时候，先把img元素或是其他元素的背景图片路径 替换成一张大小为1*1px图片的路径（这样就只需请求一次）， 只有当图片出现在浏览器的可视区域内时，才设置图片正真的路径， 让图片显示出来。这就是图片懒加载。
        <p>
            关键点如下： 1、页面中的img元素，如果没有src属性， 浏览器就不会发出请求去下载图片（也就没有请求咯，也就提高性能咯）， 一旦通过javascript设置了图片路径，浏览器才会送请求。有点按需分配的意思， 你不想看，就不给你看，你想看了就给你看~ 2、如何获取正真的路径，这个简单， 现在正真的路径存在元素的“data-url”（这个名字起个自己认识好记的就行）属性里， 要用的时候就取出来，再设置；
        </p>
        <p>
            <img data-src="./images/6.jpg" src="./image/star.png" class="lazyload" alt="" />
        </p>
    </div>
</body>
<script>
    (function(){
        var lazyloadClassName = null;
        window.addEventListener('load',_loadImage);
        window.addEventListener('scroll',_loadImage);

        /**
         * 获取页面中所有需要懒加载的图片
        */
       function _loadImage(){
           var imageList = document.querySelectorAll(".lazyload");
           for(var i = 0; i < imageList.length; i++){
               var el = imageList[i];
               if(_isToShow(el)){
                   var imageUrl = el.getAttribute("data-src");
                   el.setAttribute("src",imageUrl);
                //    将已经加载的图片去掉lazyload类名,否则会影响效率
                   el.className = el.className.replace("lazyload","loaded");
               }
           };
       };

       /**
        * 判断元素是否在可视区
       */
      function _isToShow(el){
          var coords = el.getBoundingClientRect();
          var wHeight = window.innerHeight || document.documentElement.clientHeight;
          return (coords.top >= 0 && coords.left >= 0 && coords.top <= wHeight);
      };
    })();
</script>
</html>